<% content_for :javascript do %>
  <script type="text/javascript">
    ShopifyApp.ready(function(){
      ShopifyApp.Bar.initialize({
        title: "Home",
        icon: "<%= asset_path('favicon.ico') %>"
      });
    });
  </script>
<% end %>
<p id="notice"><%= notice %></p>

<body>

<h1>Products</h1>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th>Body html</th>
      <th>Images</th>
      <th>Product type</th>
      <th>Tags</th>
      <th>Vendor</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @products.each do |product| %>
      <tr>
        <td><%= product.title %></td>
        <td><%= product.body_html %></td>
        <td><%= product.images %></td>
        <td><%= product.product_type %></td>
        <td><%= product.tags %></td>
        <td><%= product.vendor %></td>
        <td><%= link_to 'Show', product %></td>
        <td><%= link_to 'Edit', edit_product_path(product) %></td>
        <td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <td><%= button_to "Push to Store", push_path(product), {class: 'btn btn-small'} %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Product', new_product_path %>

<%= javascript_tag defer: 'defer' do -%>
  var mssg = 'aaaaaa';
  var x = 1;
  alert(x+1)
  $(document).ready(function() {

$('.btn.btn-small').click(function(){
    
    var x;
    
    if (window.confirm("defaultText") == true) {
        x = "You pressed OK!";
        //save action goes here

    data = {
      title: "Test Product",
      body_html: "Sample",
      //images: img,
      product_type: "Sample",
      tags: "import",
      vendor: vendor
    };

    $.ajax({
        type: "POST",
        //url: "https://scrapetest.herokuapp.com/create.json",
        //url: "https://shopifyapp-sample.herokuapp.com/create.json",
        url: "https://2d69dfd97a185d97d49cb4b85de5e76f:1cd78cc392fe8861b891a3f881b3c5d8@gels-store.myshopify.com/admin/products.json",
        dataType: "json",
        //headers:{ contentType: "application/json" },
        data: data,
        success: function() {
          alert('Success!!!');
          //alert(images);
        },
        error: function(data) {
          // $('.failure').fadeIn(300).delay(1500).fadeOut(400);
          alert('ew error. check logs.');
        }
      }).done(function(data, statusText, xhr){
        var status = xhr.status;                //200
        var head = xhr.getResponseHeader('Location'); //Detail header info
        alert(head.substring(head.lastIndexOf("/")+1));
      //var product_id = head.substring(head.lastIndexOf("/")+1);
      //var my_delay = 2000;

        //setTimeout(callAjax(product_id, images), my_delay);
        //setTimeout( callAjax2(product_id), my_delay);
       
      });
      
      }

      alert(x);

    });

});
<% end -%>

</body>