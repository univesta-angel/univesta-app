<html>
<% content_for :javascript do %>
  <script type="text/javascript">
    ShopifyApp.ready(function(){
      ShopifyApp.Bar.initialize({
        title: "Order Lists",
        icon: "<%= asset_path('favicon.ico') %>"
      });
    });
  </script>
  
<% end %>

<head>
  <style type="text/css">
    #page-content{
      width: 1024px;
      margin: 0 auto;
    }
    .Row {
      display: table;
      width: 100%; /*Optional*/
      table-layout: fixed; /*Optional*/
      border-spacing: 1px; /*Optional*/
      margin-top: 10px;
    }
    .Column {
      display: table-cell;
      width: 300px;
    }
    .Column2 {
      display: table-cell;
      float: right;
    }
      .aaa{
      	width: 190px;
      }
      .navbar-nav{
      	width: 1000px;
      	background-color: #2d2d2d;
      	border: 1px;
		border-radius: 3px;
		-webkit-box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.36);
		-moz-box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.36);
		box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.36);
      }
      ul.nav.navbar-nav > li > a {
      	color: white;
      }
      .search-orders {
      	margin-top: 10px;
      	margin-bottom: 20px;
      	/*margin-left: 25%;*/
      }
      #search-key {
      	float: left;
      }
      .date-range{
      	float: right;
      }
      .order-option {
      	margin-top: 10px;
      	margin-bottom: 10px;
      	/*margin-left: 26.8%;*/
      }
      .order-detail{
      	margin-top: 20px;
      	margin-left: -1px;
      	color: #000;
      	background-color: #ffffff;
      	width: 1000px;
      	border: 1px;
		border-radius: 3px;
		-webkit-box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.3);
		-moz-box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.3);
		box-shadow: 0px 2px 5px 0px rgba(0,0,0,0.3);
      }
      .order-detail > div > div > span.date {
      	margin-left: 5px;
      }
      .order-detail > div > div > a {
      	margin-left: 5px;
      	color: #76A28C;
      }
      .line-item-detail{
      	border:1px;
      	display:inline-block;
      	background-color: #F4F1DE;
      	width: 100%;
      	height: 100px;
      	margin-top: 20px;
      	margin-bottom: 10px;
      	border: 1px solid grey;
		border-radius: 3px;
      }
      .line-item-img{
      	padding: 5px;
      	margin-left: 30px;
      	margin-top: 18px;
      	border: 1px solid grey;
      }
      .line-item-title, .line-item-color, .line-item-trackNo {
      	margin-left: 30px;
      	margin-top: 18px;
      }
      .line-item-title > h6 > a {
      	color: #76A28C;
      }
      .line-item-sku{
      	margin-left: 30px;
      	margin-top: -5px;
      }
      div.line-item-color > h5, div.line-item-trackNo > h5 {
      	color: grey;
      }
      .line-item-qtyprice{
      	display: inline-block;
      	color: grey;
      	margin-left: 30px;
      	margin-top: 18px;
      	text-align: right;
      }
      .line-item-qtyprice > h5 {
      	display: inline-block;
      }
      .line-item-qtyprice > span {
      	margin-left: 15px;
      	margin-right: 15px;
      }
      .order-prd-btn{
      	background-color: #E07A5F;
      	color: white;
      }
      .add-order-btn, .mark-ship-btn {
      	background-color: white;
      	border: 1px solid grey;
      }
      .filter-btn{
      	background-color: #F2CC8F;
      }
      #daterange {
      	display: inline-block;
      	width: 240px;
      }
      #date {
      	display: inline-block;
      	float: right;
      }
  </style>

</head>


<body style="background-color: #f2f2f2">

	<div class="container-fluid text-center" id="page-content">
	  <div class="row content">

	    <!-- start of center colum -->
	    <div class="col-sm-12 text-left">
      		<div><p id="notice"><%= notice %></p></div>	
			<br/>

			<div class="row">
			    <div class="col-md-12">
			    	<div class="search-orders">
				    <%= form_tag(my_products_path, method: :get) do %>
			            <%= text_field_tag "searchprd", params[:searchprd], class: "form-control", placeholder: "Seach for Products", style: "width: 390px;" %>
			            <button type="submit" class="btn btn-default filter-btn" style="margin-left: 10px;  margin-right: 10px; width: 70px">Filter</button>
			            <div class="form-group has-feedback" id="date">
				            <input type="text" name="datefilter" value="" class="form-control" id="daterange" placeholder="Select Date Range" />
				            <i class="glyphicon glyphicon-calendar form-control-feedback"></i>
			            </div>
			          <% end %>
		          	</div>
			    </div>
		    </div>

		    <div class="row order-option">
			    <ul class="nav navbar-nav">
				  <li role="presentation" class="dropdown">
				    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
				      Fulfillment Status: All <span class="caret"></span>
				    </a>
				    <ul class="dropdown-menu">
				    	<li><input type="checkbox" name="vehicle" value="Bike">Unknown</li>
			            <li><input type="checkbox" name="vehicle" value="Bike">Fulfilled</li>
			            <li><input type="checkbox" name="vehicle" value="Bike">Unfulfilled</li>
			            <li><input type="checkbox" name="vehicle" value="Bike">Partial</li>
				    </ul>
				  </li>
				  <li role="presentation" class="dropdown">
				    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
				      Financial Status: All <span class="caret"></span>
				    </a>
				    <ul class="dropdown-menu">
				    	<li>ABC</li>
				    </ul>
				  </li>
				  <li role="presentation" class="dropdown">
				    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
				      Flags Status: All <span class="caret"></span>
				    </a>
				    <ul class="dropdown-menu">
				    	<li>ABC</li>
				    </ul>
				  </li>
				  <li role="presentation" class="dropdown">
				    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
				      Order Status: All <span class="caret"></span>
				    </a>
				    <ul class="dropdown-menu">
				    	<li>ABC</li>
				    </ul>
				  </li>
				  <li role="presentation" class="dropdown">
				    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
				      Sources Status: All <span class="caret"></span>
				    </a>
				    <ul class="dropdown-menu">
				    	<li>ABC</li>
				    </ul>
				  </li>
				</ul>
	    	</div>
		    
		<% @orders.each do |order| %>
			<div class="row">
		        <div class="container order-detail">
		          <div class="Row">
				  
		    	<% ae_url = '' %>
			<% pid = 0 %>
			<% order.line_items.each do |item| %>
				<% pid = item.product_id %>
			<% end %>
			<% product = ShopifyAPI::Product.find(pid) %>
			<% metafield = product.metafields %>
			<% metafield.each do |m| %>
				<% ae_url = m.value %>
			<% end %>
		    	<% ae_link = 'https://www.aliexpress.com/item/'+ ae_url +'.html' %>
			<%= hidden_field_tag :prd_link, ae_link, id: 'ae_link_'+order.order_number.to_s %>
			<%= hidden_field_tag :country, order.shipping_address.country, id: 'country_'+order.order_number.to_s %>				  
			<%= hidden_field_tag :province, order.shipping_address.province, id: 'province_'+order.order_number.to_s %>
			<%= hidden_field_tag :address1, order.shipping_address.address1, id: 'address1_'+order.order_number.to_s %>
			<%= hidden_field_tag :address2, order.shipping_address.address2, id: 'address2_'+order.order_number.to_s %>
			<%= hidden_field_tag :city, order.shipping_address.city, id: 'city_'+order.order_number.to_s %>				  
			<%= hidden_field_tag :zip, order.shipping_address.zip, id: 'zip_'+order.order_number.to_s %>				  
			<%= hidden_field_tag :phone, order.shipping_address.phone, id: 'phone_'+order.order_number.to_s %>
				  
		            <div class="col-md-4">Order #<%= link_to order.order_number, "https://2d69dfd97a185d97d49cb4b85de5e76f:1cd78cc392fe8861b891a3f881b3c5d8@gels-store.myshopify.com/admin/products/#{order.id}", method: "get", target: "_blank" %><span class="date"><%= order.created_at %></span></div>
				  <div class="col-md-3">Customer: <%= link_to order.shipping_address.name, "https://2d69dfd97a185d97d49cb4b85de5e76f:1cd78cc392fe8861b891a3f881b3c5d8@gels-store.myshopify.com/admin/products/#{order.customer.id}", method: "get", target: "_blank", id: "customername_#{order.order_number}", class: "customername" %></div>
				  <div class="col-md-3">Add Note</div>
		            <div class="Column2"><button type="button" class="btn btn-default mark-ship-btn">Mark as Shipped</button></div>
		          </div>
		          <hr>
		          <div class="Row">
		            <div class="col-md-3"><span class="label label-warning" style="margin-right: 10px">To Order</span>Supplier: <a href="#">Warehouse #0001</a></div>
		            <div class="col-md-3">Ali Order No:<button type="button" class="btn btn-sm add-order-btn" style="margin-left: 20px;">Add</button></div>
		            <div class="col-md-3">Shipped:<b style="margin-left: 5px">0/1</b><button type="button" class="btn btn-sm mark-ship-btn" style="margin-left: 10px">Mark as Shipped</button></div>
		            <div class="Column2"><%= button_tag "Order Product", id: 'order-btn', class: 'btn btn-default order-prd-btn', data_id: order.order_number %></div>
		          </div>
		            <div class="line-item-detail">
		                    <!-- line items -->
			    <% order.line_items.each do |item| %>
		                <div class="row">

			  	<div class="col-md-1">
		                    <div>
		                    	<img src="http://placehold.it/50x50" class="line-item-img">
		                    </div>
				</div>

		                <div class="col-md-3">
		                    <div class="line-item-title">
		                    	<h6><a><%= item.title %></a></h6>
	                    	</div>
		                    <div class="line-item-sku">
		                    	<h6 style="color: grey"><%= item.sku %></h6>
		                    </div>
	                      	</div>

		                <div class="col-md-2">
		                  	<div class="line-item-color">
						<h5><p id="variant_option_<%= order.order_number %>"><%= item.variant_title %></p></h5>
					</div>
		                </div>

		                  <div class="col-md-2">
		                  	<div class="line-item-trackNo">
		                  		<h5>No Tracking Number</h5>
		                  	</div>
                		  </div>

		                  <div class="col-md-3">
		                  	<div class="line-item-qtyprice">
						<h5 id="quantity_<%= order.order_number %>"><%= item.quantity %></h5><span>&times;</span><h5><%= item.price %></h5>
		                  	</div>
		                  </div>
	            		</div>
				<% end %>
	            		
	              	</div>
	        	</div>
			</div>
		<% end %>

	    </div>
	    <!-- end of center column -->

	  </div>
	</div>

</body>
</html>
